
## Phenobooth Image Analysis PIA 2.0
This is a pipeline based on Matlab to analyze and extract the colony data from Phenobooth+ images.

## Matlab add-ons to set up in advance
- Image Processing Toolbox: image processing package
- Active Figure Zoom for Selection Points: to zoom and pick points for `segment`

## Documentation

To look at the documentation for each function in more details please use `help` in Matlab, e.g.:
```matlab
help background
```

### Background correction
use syntax `background` to correct the background brightness bias
Carefully choose your template image, as this may affect the background correction. The location of the plate on the Phenobooth image may vary from batch to batch - an option "Adjust" in `background` is written but not debugged yet. A suggestion would be to use a different template image if possible.
```matlab
background("B","../imcomplement_model.png","InDir", "../example/00_raw images","OutDir", "../example/01_background correction")
```

### Select focus area manually
Pick points on the image to generate crop axes, pick the centers of A1, A12, H1, H12 - has to be this exact order.
```matlab
focus("Image","../example/01_background correction/bgcorrection_Run-1-Plate-001 - Original.png","OutDir","../example/02_crop and filter")
```

### Crop and filter
Crop the image based on the files generated by `focus`
```matlab
piafilter("Mode","pick","FocusDir","../example/02_crop and filter/",...
          "InDir","../example/01_background correction","OutDir","../example/02_crop and filter",...
          "Rescue", "no","RescueValue", 0.75,...
          "FilterValue",104)
```

### Edge light correction
Phenobooth images sometimes have strong light reflections near A row and H row, erase those - be careful as this might erase part of the colonies
```matlab
edgelight("InDir","../example/02_crop and filter", "OutDir","../example/03_edge light correction",...
          "Thichness", 17, "Radius", 10, "Ellipticity", 1.1, "Height", 50) 
```

### Segmentation
To manually draw lines between colonies to separate overlapping colonies. Press 'esc' to skip the shown image, and press any other key on the keyboard, e.g. 'a', to enter the selection mode for this image. In the selection mode, drag and hold to select an area to zoom in, then left-click and a black line will be drawn between the clicks to separate as desired. 
```matlab
segment("Mode","manual",
        "InDir", "../example/03_edge light correction",...
        "OutDir","../example/04_segmentation",...
        "Coord", "../example/02_crop and filter")
```

### Calculation and analysis
```matlab
calculate("Thickness", 0.4, ...
          "InDir","../example/04_segmentation",...
          "OutDir","../example/05_calculation",...
          "Coord", "../example/02_crop and filter",...
          "Radius", 16, "Ellipticity", 1.1)

```

### Visualization
TODO

